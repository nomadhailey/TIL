####MPA/SPA, CSR/SSR, SEO

##### MPA(Multiple Page Application)

사용자가 페이지를 요청할 때마다, 웹 서버가 요청한 UI와 필요한 데이터를 HTML로 파싱해서 보여주는 방식의 웹 어플리케이션이다. 사용자가 아주 사소한 요청을 해주어도(버튼 클릭 등) 매번 전체 페이지를 렌더링 해주어야 한다.

- 장점
  - SEO 관점에서 유리하다 : MPA는 완성된 형태의 HTML 파일을 서버에서 전달받기에 검색엔진이 페이지를 크롤링하기에 적합하다.
- 단점
  - 매번 페이지 전체를 새로 불러와서 렌더링 해야 하기 때문에 화면이 깜빡이는 등 성능상의 이슈가 있다.
  - 프론트와 백이 밀접하게 연관되어 있어서 개발 복잡도가 증가한다.

##### SPA

몇년 전부터 React, Angular, Vue와 같은 SPA 방식의 Front-end 개발 방식이 크게 유행하고 있습니다. 이는 매우 빠른 랜더링을 제공하므로 페이지 전환 시 페이지가 하얗게 되는 현상을 방지할 수 있으며 웹앱으로 개발 시에도 Native 앱과 크게 차이가 없는 서비스를 제공할 수 있다는 장점이 있습니다.

최초 한번 페이지를 로딩한 이후 JS를 이용해 동적으로 데이터만 변경하여 화면의 컨텐츠를 바꾸는 방식의 웹 어플리케이션이다.

웹에서 제공하는 정보량이 많아지고 데스크탑보다 성능이 떨어지는 모바일에 최적화시키기 위해 등장.

서버는 단지 JSON 파일만 보내주는 역할을 수행하며 HTML을 그리는 역할은 클라이언트에서 JS로 수행한다. 그리고 이러한 방식이 CSR이다.

- 장점

  - 사용자 경험 측면에서 좋다. 성능이 우수하다.
  - 서버 없이도 개발이 가능하며 디버깅이 상대적으로 쉽다.
  - 로컬 데이터를 효과적으로 캐시(cache)할 수 있다. 처음에 받은 데이터를 모두 로컬 캐시에 저장해 놓아서 오프라인에서도 사용할 수 있다.

- 단점

  - 초기 구동 속도가 느리다. 초기에 웹 어플리케이션에 필요한 모든 정적 리소스를 다 받아야 하기 때문이다.

  - SEO 관점에서 불리하다. 최근 구글에서는 검색 봇이 이를 감지하여 별다른 조치 없이도 SPA에서 SEO가 가능하도록 지원하고 있으나 다른 검색 사이트에서는 아직 이러한 기능을 적용하지 않고 있습니다.

    

#####SPA와 CSR

* MPA가 주로 SSR을 사용하고, SPA가 주로 CSR을 사용한다.
* SPA가 1.서버로부터 처음에 페이지(정적 리소스)를 받아오고 2.이후에는 동적으로 DOM을 구성하여 렌더링 되는 화면이 바뀌게 한다고 했는데 여기서 2번에 대한 개념이 CSR인 것이다. SPA에서 SSR을 사용하는 경우가 있는데 이는 위의 문장에서 1번에서 가져온 리소스를 SSR로 렌더링 하는 것이다.

- 대표적으로 React, Vue등이 SPA를 만드는 JS 라이브러리에 해당하는데 React의 경우 한 페이지를 여러개의 컴포넌트로 나누어 각각 따로 동작하도록 합니다. 따라서 최초 페이지의 로드에서는 각 컴포넌트가 서버에 각기 다른 요청을 하므로 로딩이 SSR에 비해 늦지만 이후에는 변경이 필요한 컴포넌트만 요청하여 필요한 변경을 하기 때문에 이 후에는 빠른 렌더링 속도를 보여주게 됩니다. 특히 요즘 처럼 한 페이지에서 전달하려는 정보가 많은 때에 적합하기 때문에(SPA) CSR이 웹 개발의 주류를 이루게 되었습니다.

  하지만 CSR에도 단점이 있습니다. 위에 말씀드렸듯이 일반적으로 CSR은 React와 같은 라이브러리에 의해 개발이 되는데 리액트는 .jsx그리고 Vue는 .vue와 같은 파일로 생성이 되기 때문에 HTML만을 파싱하는 검색 엔진에 노출이 되지 않습니다.

##### SSR

서버에서 정적인 페이지로 렌더링 되어 사용자에게 내려오는 것을 의미한다. 따라서 초기 로딩속도가 빠르고(JS 파일을 다운로드하고 적용하기 전에 이미 브라우저에서 보여지기 때문) SEO에 사용되는 meta 태그들이 미리 정의되어 SEO 에 유리하다.

SSR은 페이지의 작은 부분 중 하나만을 업데이트 할 일이 생기더라도 페이지 전체를 다시 서버가 계산하여 로드를 해야 하는 불필요한 리소스 낭비가 생기게 됩니다.

##### CSR

브라우저가 자바스크립트를 받아와 동적으로 렌더링한다. 첫 로딩시에 필요한 파일크기는 더 크지만(HTML, JS, 그외 리소스 모두 포함) 다 받기만 하면 동적으로 빠르게 렌더링 하기 때문에 사용자가 느끼는 UX에 유리하다. SSR과는 다르게 하나의 HTML파일로 모든 페이지를 구성하기 때문에 meta 태그 정의에 약점이 있다.

CSR은 매번 서버가 뷰를 생성하는 것이 아니라 최초에만 서버가 뷰를 만들어주고 이 후에는 업데이트가 필요한 부분만 따로 클라이언트 측에서 결정하고 계산하고 요청하여 응답을 받아서 그 부분만 업데이트를 시키는 방식을 의미합니다.

##### 초기 view 로딩 속도

전통적인 SSR의 경우에는 View를 서버에서 렌더링해 가져오기 때문에, 첫 로딩이 매우 짧다. 물론 SSR을 사용하면 클라이언트에서 JS 파일을 모두 다운로드하고 적용하기 전까지는 각각의 기능이 동작하지 않겠지만, 사용자의 입장에서는 매우 빠른 속도로 로딩이 됐다고 생각할 것이다.

반면에 CSR은 서버에서 View를 렌더링하지 않기 때문에, HTML와 JS 파일, 서비스에 필요한 리소스를 다운로드한 후 브라우저에서 렌더링 해 보여준다. 그렇기 때문에 SSR보다는 초기 View를 보기까지의 시간이 길다. 하지만, 보여진 기능 모두 사용자에게 보여지는 것과 동시에 동작한다.

##### SEO 문제

대부분의 웹 크롤러, 봇들은 JS를 실행시키지 못하고 HTML에서만 컨텐츠를 수집하기 때문에
CSR 방식으로 개발된 페이지를 빈 페이지로 인식하게 됩니다.

SSR 방식은 View를 서버에서 전부 렌더링하기 때문에 HTML에 모든 컨텐츠가 저장되어 있어 SEO를 사용하는데 문제가 없습니다.

##### 정리

전통적인 SSR은 초기 로딩 속도가 빠르고 SEO에 유리하지만, View 변경(화면 전환) 시 계속적으로(새로고침하며) 서버에 요청해야 하므로 서버에 부담이 크다. 그리고 CSR은 초기 로딩 속도가 느리고 SEO에 대한 문제가 있지만, 초기 로딩 후에는 View를 서버에 요청하는 것이 아닌 Client에서 직접 렌더링하기 때문에 화면 전환이 매우 빠르다는 장점이 있다.

그래서 이를 해결하고자 최근에는 이 두 가지 렌더링 방법을 적절하게 융합한 방법들도 나오고 있다. 즉, 첫 번째 페이지 로딩에서는 서버 사이드 렌더링을 사용하고, 그 후에 모든 페이지 로드에는 클라이언트 사이드 렌더링을 활용하는 방안이 그것이다.

또는 CSR에서 메타 태그를 정의해주는 라이브러리를 사용하는 것도 방법이다. 대표적인 라이브러리로 `react-helmet`이 있다. 이 라이브러리는 동적으로 SEO에 필요한 메타태그들을 쉽게 변경할 수 있도록 도와준다. JSX 또는 TSX 내부에서 메타태그를 관리할 수 있다.

![img](https://kyj7337.github.io/static/d53c5b0658e5aaba27d9cb87b387c034/e46b2/CSRSSR.webp)